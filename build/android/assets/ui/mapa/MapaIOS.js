function MapaIOS(){{var e="",t=Ti.Platform.osname;Ti.Platform.version,Ti.Platform.displayCaps.platformHeight,Ti.Platform.displayCaps.platformWidth}e="iphone"===t||"ipad"===t?"":"mobileweb"===t?"":"/",Ti.API.info("Ruta1:"+Titanium.Filesystem.getResourcesDirectory()),Ti.API.info("Ruta2:"+Titanium.Filesystem.getApplicationDataDirectory());var a=Titanium.Network.createHTTPClient({onload:function(){Ti.API.info("Se actualizó la bd de Posiciones de los Trucks.");var e=JSON.parse(this.responseText),t=(this.reply||[],e.numtrucks),a=e.trucks;for(Ti.API.info("Se actualizó la bd de Posiciones de los Trucks."+a),Ti.API.info("Se actualizó la bd de Posiciones de los Trucks."+a[0]),i=0;t>i;i++){var o=a[i],n=Titanium.Filesystem.getFile(Titanium.Filesystem.getApplicationDataDirectory(),a[i].idTruck+".json");n.exists()&&n.deleteFile(),n.write('{"datos":'+JSON.stringify(o)+"}"),Ti.API.info("Actualizo archivo de Truck desde APD:"+o)}var r=Titanium.Filesystem.getFile(Titanium.Filesystem.getApplicationDataDirectory(),"numtrucks.json");r.write('{"trucks":'+t+"}")},onerror:function(){},timeout:1e3});a.open("GET","http://s544443713.onlinehome.mx/AppTrucks/app/getTrucksPositions.php"),a.send();var o=Titanium.UI.createWindow({backgroundColor:"white",exitOnClose:!1,modal:!0,layout:"composite",navBarHidden:!0}),n=Ti.Platform.displayCaps.platformWidth,r=(Ti.Platform.displayCaps.platformHeight,Titanium.UI.createButton({backgroundImage:e+"ui/img/android/header.png",top:"0px",left:"0",height:"110px",width:n+"px"}));r.addEventListener("click",function(){o.close()});var d=Titanium.UI.createView({backgroundImage:e+"ui/img/android/barra-menu.jpg",top:"0px",height:"15%",widht:n+"px",zIndex:9999,layout:"composite"});d.addEventListener("click",function(){o.close()});var l=Titanium.UI.createView({backgroundColor:"transparent",height:"90px",widht:"80%",zIndex:9999}),s=Titanium.UI.createImageView({image:e+"ui/img/android/camion.png",left:"10%",width:"12%",height:"62%",zIndex:9999}),m=Titanium.UI.createImageView({image:e+"ui/img/android/titulo.png",left:"24%",width:"65%",height:"60%",zIndex:9999});l.add(s),l.add(m),d.add(l),o.add(d);var c=Titanium.UI.createImageView({image:e+"ui/img/android/radar-banner.png",top:"20%",left:"0%",width:"25%",height:"10%",zIndex:9999});o.add(c);var u=("android"===Ti.Platform.name?16:14,Titanium.UI.createButton({backgroundColor:"#0F5E8B",color:"white",title:"TrucksApp",textAlign:"center",top:0,left:0,height:"12%",width:n,tintColor:"white"}),require("ti.map")),p=0,g=Titanium.Filesystem.getFile(Titanium.Filesystem.getApplicationDataDirectory(),"numtrucks.json");g.exists()?(fileTmp=JSON.parse(g.read().text),p=fileTmp.trucks,Ti.API.info("Num Trucks desde APD"+p)):(g=Titanium.Filesystem.getFile(Titanium.Filesystem.getResourcesDirectory(),"numtrucks.json"),fileTmp=JSON.parse(g.read().text),p=fileTmp.trucks,Ti.API.info("Num Trucks desde APD"+p));var T=new Array(p);for(i=0;p>i;i++){Ti.API.info("Buscando Archivo:"+(i+1)+".json");var f=Titanium.Filesystem.getFile(Titanium.Filesystem.getApplicationDataDirectory(),i+1+".json"),h=[],I="";f.exists()?(I=Titanium.Filesystem.getApplicationDataDirectory(),h=JSON.parse(f.read().text),Ti.API.info("Se obtienen datos de AD"+h)):(I=Titanium.Filesystem.getResourcesDirectory()+"/ui/img/android/",f=Titanium.Filesystem.getFile(Titanium.Filesystem.getResourcesDirectory(),"1.json"),f.exists()?(h=JSON.parse(f.read().text),Ti.API.info("Se obtienen datos de RD"+h.datos[0]),Ti.API.info("Se obtienen datos de RD"+h.datos.id)):Ti.API.info("No se pudieron obtener los datos")),T[i]=u.createAnnotation({latitude:h.datos.latitud,longitude:h.datos.longitude,centerOffset:{x:80,y:25},image:I+h.datos.idTruck+"s.png",title:h.datos.nombre,subtitle:"Truck",myid:h.datos.idTruck,rightButton:Ti.UI.iPhone.SystemButton.CONTACT_ADD})}var v=Ti.UI.createWindow({backgroundColor:"white"}),w=(Titanium.UI.createTab({icon:"KS_nav_views.png",title:"Tab 1",window:v}),u.createView({mapType:u.NORMAL_TYPE,region:{latitude:currentLat,longitude:currentLon,latitudeDelta:.05,longitudeDelta:.05},userLocation:!0,height:"100%",top:0,left:0,width:"100%",annotations:T}));w.addEventListener("click",function(i){var e=i.clicksource;if(Ti.API.info(e+"Annotation "+i.title+" clicked, id: "+i.annotation.myid),"rightButton"==e){var t=require("ui/perfil/PerfilIos");new t(""+i.annotation.myid).open()}if("subtitle"==e){var t=require("ui/perfil/PerfilIos");new t(""+i.annotation.myid).open()}}),o.add(w);var A=Titanium.UI.createView({backgroundImage:e+"ui/img/android/barra-menu.jpg",top:"85%",height:"15%",widht:n+"px",zIndex:9999,layout:"composite"});o.add(A);var y=Titanium.UI.createImageView({image:e+"ui/img/android/gps-radar.png",top:"88%",left:"3%",width:"10%",height:"7%",zIndex:9999}),k=Titanium.UI.createImageView({image:e+"ui/img/android/truck-radar.png",top:"88%",left:"17%",width:"10%",height:"7%",zIndex:9999}),P=Titanium.UI.createImageView({image:e+"ui/img/android/promo-radar.png",top:"88%",left:"31%",width:"10%",height:"7%",zIndex:9999}),b=Titanium.UI.createImageView({image:e+"ui/img/android/estrella-radar.png",top:"88%",left:"45%",width:"10%",height:"7%",zIndex:9999}),x=Titanium.UI.createImageView({image:e+"ui/img/android/eventos-radar.png",top:"88%",left:"59%",width:"10%",height:"7%",zIndex:9999}),S=Titanium.UI.createImageView({image:e+"ui/img/android/antojo-radar.png",top:"88%",left:"73%",width:"10%",height:"7%",zIndex:9999}),F=Titanium.UI.createImageView({image:e+"ui/img/android/magazine-radar.png",top:"88%",left:"87%",width:"10%",height:"7%",zIndex:9999});return o.add(y),o.add(k),o.add(P),o.add(b),o.add(x),o.add(S),o.add(F),o}module.exports=MapaIOS;